---
title: "mmstat4"
author: 
- name: "Sigbert Klinke" 
  email: sigbert@hu-berlin.de
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  html_document:
    toc: true
    toc_depth: 4
vignette: > 
  %\VignetteIndexEntry{mmstat4} 
  %\VignetteEngine{knitr::rmarkdown} 
  \usepackage[utf8]{inputenc} 
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r , echo=FALSE}
suppressPackageStartupMessages(library("mmstat4"))
```

# General

The aim of this package is to provide teaching materials for various statistics courses for students.
The materials (R code snippets, Shiny apps, HTML and PDF documents, datasets, ...) are stored in a GitHub repository. GitHub allows the download of the repository as a ZIP file, see in the repository under the `Code` button (`Download ZIP`). `mmstat4` works with this ZIP file, but you can use any ZIP files.

In my courses I assume that all R programs run in a freshly started R, i.e. there are no path dependencies, all necessary libraries are loaded in the R program and so on. My repositories contain not only the sample programs for the students but also the programs I use to generate images and tables and also the Shiny Apps I show.

# Using a ZIP file or repository

## `ghget`

A ZIP file or repository can be stored locally or in the internet.
A user defined key has to be given for the location of the ZIP file

```{r, eval=FALSE}
ghget(dummy="https://github.com/sigbertklinke/mmstat4.dummy/archive/refs/heads/main.zip")
```

Three repositories are predefined: `hu.data`, `hu.stat` and `dummy`. You can fetch then via

```{r, eval=FALSE}
ghget('dummy')
ghget('hu.stat')
ghget('hu.data')
ghget()           # uses hu.data
```

`ghget` downloads the ZIP file, stores in temporary location and unpacks it. For non-temporary location see the FAQ.

## Full and short names for files

In addition, unique short names, related to the zip file content, are generated from the path components.

```{r}
# downloads a small repository and makes it the current one
ghget("dummy")    
ghrepos()                        # information about all repos
ghlist("BANK2", full.names=TRUE) # full names
ghlist("BANK2")                  # short names
```

## `ghopen`, `ghload`, `ghsource`

The short names (or the full names) can be used to work with the files

```{r, eval=FALSE}
x <- ghload("data/BANK2.sav")
ghopen("univariate/example_ecdf.R")
ghsource("univariate/example_ecdf.R")
```

## `ghlist`, `ghquery`

With `ghlist` you can get a list of unique (short) names for all files or a subset based on a regular expression `pattern` in the repository

```{r}
str(ghlist())
ghlist("\\.pdf$") # get all PDF files
```

With `ghquery` you can query the list of unique (short) names for all files based on the overlap distance.

```{r}
ghlist("bnk")  # pattern = "bnk
ghquery("bnk") # nearest string matching to "bnk"
```

## `ghfile`, `ghpath`, `ghdecompose`

`ghfile` tries to find a unique match for a given and returns the full path. If there is no unqiue match then an error is thrown with some candidate matches.

`ghdecompose` builds a data frame and decompses the full names of the files into 

* `commonpath` the path part which is common to all files,
* `uniquepath` the path part which is unique to all files,
* `minpath` the minimal path part such that all files addressable in unique manner,
* `filename` the basename of the file, and
* `source` the input to shortpath.

The short names for the files are build by the components `minpath` and `filename`.

`ghpath` builds from a `ghdecompose` object the short name with various path parts included.

```{r}
ghfile('data/BANK2.sav')
ghget(local=system.file("zip", "mmstat4.dummy.zip", package="mmstat4"))
fnf <- ghlist(full.names=TRUE)
dfn <- ghdecompose(fnf)
head(dfn)
head(ghpath(dfn))
```

## RStudio addins

The package comes with two RStudio addins (see under `Addins -> MMSTAT4`):

* _Open a file from a zip file_ (`ghopenAddin`) which gives access to the unpacked zip file and opens the choosen file into a RStudio editor window.

* _Runs a Shiny app from a zip file_ (`ghappAddin`) which extracts all directories with Shiny apps and opens the choosen app in a web browser (using the default browser).

# Preparations for a ZIP file

Currently there are the following routines to support R code snippets:

* `Rsolo` which checks if each R code snippet runs smoothly in a freshly started R. If an error occurs, the execution is interrupted and 
* `Rlibs` which extracts all `library` and `require` calls from the R code snippets and returns a frequency table of called packages.

```{r}
ghget(local=system.file("zip", "mmstat4.dummy.zip", package="mmstat4"))
files <- ghlist(pattern="*.R$", full.names = TRUE)
head(Rlibs(files), 30)
# just check the last files from the list 
# Note that the R console will show more output (warnings etc.)
Rsolo(files, start=435)  
# a full run would take a bit since we have 437 R files and 
# it will throw an error quickly :(
```



# Frequently asked questions

## How can I force a reload of a zip file?

```{r, eval=FALSE}
ghget("dummy", .force=TRUE)
```

## How can I store a zip file permanently or temporarily?

```{r, eval=FALSE}
ghget("dummy")                        # install temporarily
ghget("dummy", .tempdir=FALSE)        # install non-temporarily
ghget("dummy", .tempdir="~/mmstat4")  # install non-temporarily to ~/mmstat4
```

Note: If a repository was installed permanently and you switch back to temporarily storage then the downloaded files will not be deleted.

## How can I find all directories with Shiny apps?

```{r, eval=FALSE}
ghget("dummy", .tempdir=TRUE)
ghlist(pattern="/(app|server)\\.R$")
ghopen("dbscan") # open the app
```

## How can I find all `csv` data files?

```{r}
ghget("dummy", .tempdir=TRUE)
ghlist(pattern="\\.csv$", ignore.case=TRUE, full.names=TRUE)
# use mmstat4 for importing
ghlist(pattern="\\.csv$")
pechstein <- ghload("pechstein.csv")
str(pechstein)
```

# Default repositories

The package has three default repositories: `dummy`, `hu.stat`, and  `hu.data`. 

```{r, echo=FALSE, message=FALSE, warnings=FALSE, results='asis'}
tabl <- "
| Repository       | Size          | ZIP file location |
| :--------------- | :-------------| :--------|
| `dummy`          | 3 MB          | `https://github.com/sigbertklinke/mmstat4.dummy/archive/refs/heads/main.zip`  |
| `hu.stat`        | 29 MB         | `https://github.com/sigbertklinke/mmstat4.data/archive/refs/heads/main.zip`   |
| `hu.data`        | 31 MB         | `https://github.com/sigbertklinke/mmstat4.stat/archive/refs/heads/main.zip`   |
"
cat(tabl) 
```

`dummy` is small subsample of `hu.stat` and `hu.data` which is intended for examples and test purposes. 

## Lecture Notes Sigbert Klinke, HU Berlin

### Basic statistics I+II (in german)

Mathematische Grundlagen - Einführung - Grundbegriffe - Univariate Verteilungen - Parameter  univariater Verteilungen - Bivariate Verteilungen - Parameter bivariater Verteilungen - Regressionanalyse - Zeitreihenanalyse - Indexzahlen - Wahrscheinlichkeitsrechnung - Zufallsvariablen - So lügt man mit Statistik - Wichtige Verteilungsmodelle - Stichprobentheorie - Statistische Schätzverfahren - Regressionsmodell - Konfidenzintervalle - Statistische Testverfahren - Parameterische Tests - Nichtparametrische Tests

```{r, eval=FALSE}
ghget("hu.stat")
ghopen("Statistik.pdf")
ghopen("Aufgaben.pdf")
ghopen("Loesungen.pdf")
ghopen("Formelsammlung.pdf")
```

### Data analysis

General - R - Basics and data generation - Test and estimation theory - Parameter of
distributions - Distribution - Transformations - Robust statistics - Missing values -
Subgroup analysis - Correlation and association - Multivariate graphics - Principal component analysis - Exploratory factor analysis - Reliability - Cluster analysis -
Regression analysis - Linear regression - Nonparametric regression - Classification and regression trees - Neural networks

```{r, eval=FALSE}
ghget("hu.data")
ghopen("dataanalysis.pdf")
```

## Lecture Notes Bernd Rönz, HU Berlin (in german)

### Computergestützte Statistik I mit SPSS 10 (2001)

Einführung - Entdeckung und Identifikation von Ausreißern - Prüfung der Verteilungsform von Variablen - Parametervergleiche bei unbhängigen Stichproben - Anhänge A-D, Literaturverzeichnis, Index

```{r, eval=FALSE}
ghget("hu.data")
ghopen("cs1_roenz.pdf")
```

### Computergestützte Statistik II mit SPSS 10 (2000)

Vorwort - Überprüfung von Zusammenhängen - Regressionsanalyse - Reliabilitäts- und Homogenitätsanalyse von Konstrukten - Anhänge A-H, Literaturverzeichnis, Stichwortverzeichnis

```{r, eval=FALSE}
ghget("hu.data")
ghopen("cs2_roenz.pdf")
```

### Generalisierte lineare Modelle mit SPSS 10 (2001)

Einführung - Verallgemeinerte lineare Modelle (generalized linear models, GLM) - Modellierung binärer Daten - Das multinomiale Logit Modell - Modellierung multinomialer Daten (log-lineare Modelle) - Literaturverzeichnis, Index 

```{r, eval=FALSE}
ghget("hu.data")
ghopen("glm_roenz.pdf")
```
